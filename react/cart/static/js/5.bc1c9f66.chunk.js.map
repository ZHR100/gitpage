{"version":3,"sources":["models/cart.js"],"names":["namespace","state","carts","subscriptions","effects","reducers","getData","payload","localStorage","getItem","JSON","parse","add","data","newData","count","json","stringify","setItem","findIndex","value","id","size","newArr","changeCount","filter","item","clear"],"mappings":"gJAAe,WACbA,UAAW,OAEXC,MAAO,CACLC,MAAO,MAGTC,cAAe,GAEfC,QAAS,GAOTC,SAAU,CACRC,QADQ,SACAL,EADA,GACoB,EAAXM,QAGf,OADaC,aAAaC,QAAQ,QAEzB,CAAEP,MAAOQ,KAAKC,MAAMH,aAAaC,QAAQ,UAE3C,CAAEP,MAAO,OAElBU,IATQ,SASJX,EATI,GASuB,IAATY,EAAQ,EAAjBN,QACHL,EAAUD,EAAVC,MACR,IAAKA,GAASW,EAAM,CAClB,IAAMC,EAAO,eAAQD,EAAR,CAAcE,MAAO,IAC5BC,EAAON,KAAKO,UAAU,CAACH,IAE7B,OADAN,aAAaU,QAAQ,OAAQF,GACtB,CAAEd,MAAO,CAACY,IAEnB,IAAMK,EAAYjB,EAAMiB,WAAU,SAACC,GACjC,OAAOA,EAAMC,KAAOR,EAAKQ,IAAMD,EAAME,OAAST,EAAKS,QAErD,IAAmB,IAAfH,EAAkB,CACpB,IAAII,EAAM,YAAOrB,GACjBqB,EAAOJ,GAAP,eACKI,EAAOJ,GADZ,CAEEJ,MAAOQ,EAAOJ,GAAWJ,MAAQ,IAEnC,IAAMC,EAAON,KAAKO,UAAUM,GAE5B,OADAf,aAAaU,QAAQ,OAAQF,GACtB,CAAEd,MAAOqB,GAElB,IAAMT,EAAO,eAAQD,EAAR,CAAcE,MAAO,IAC5BC,EAAON,KAAKO,UAAL,sBAAmBf,GAAnB,CAA0BY,KAEvC,OADAN,aAAaU,QAAQ,OAAQF,GACtB,CAAEd,MAAM,GAAD,mBAAMA,GAAN,CAAaY,MAE7BU,YAnCQ,SAmCIvB,EAnCJ,GAmCyB,IAM3BsB,EANehB,EAAW,EAAXA,QACXL,EAAUD,EAAVC,MACAa,EAAgBR,EAAhBQ,MAAOF,EAASN,EAATM,KACTM,EAAYjB,EAAMiB,WAAU,SAACC,GACjC,OAAOA,EAAMC,KAAOR,EAAKQ,IAAMD,EAAME,OAAST,EAAKS,QAGvC,IAAVP,EACFQ,EAASrB,EAAMuB,QAAO,SAAAC,GAAI,QAAMA,EAAKL,KAAOR,EAAKQ,IAAMK,EAAKJ,OAAST,EAAKS,UAE1EC,EAAM,YAAOrB,IACNiB,GAAP,eACKI,EAAOJ,GADZ,CAEEJ,MAAOA,IAGX,IAAMC,EAAON,KAAKO,UAAUM,GAE5B,OADAf,aAAaU,QAAQ,OAAQF,GACtB,CAAEd,MAAOqB,IAElBI,MAvDQ,SAuDF1B,EAvDE,GAuDwB,EAAjBM,QAEb,OADAC,aAAaU,QAAQ,OAAQ,IACtB,eAAKjB,EAAZ,CAAmBC,MAAO","file":"static/js/5.bc1c9f66.chunk.js","sourcesContent":["export default {\r\n  namespace: \"cart\",\r\n\r\n  state: {\r\n    carts: null,\r\n  },\r\n\r\n  subscriptions: {},\r\n\r\n  effects: {\r\n    // *getData(action, { call, put }) {\r\n    //   const data = localStorage.getItem(\"cart\");\r\n    //   yield put({ type: \"save\", payload: data });\r\n    // },\r\n  },\r\n\r\n  reducers: {\r\n    getData(state, { payload }) {\r\n      // 保存数据到 state\r\n      const data = localStorage.getItem(\"cart\");\r\n      if (data) {\r\n        return { carts: JSON.parse(localStorage.getItem(\"cart\")) };\r\n      }\r\n      return { carts: null };\r\n    },\r\n    add(state, { payload: data }) {\r\n      const { carts } = state;\r\n      if (!carts && data) {\r\n        const newData = { ...data, count: 1 };\r\n        const json = JSON.stringify([newData]);\r\n        localStorage.setItem(\"cart\", json);\r\n        return { carts: [newData] };\r\n      }\r\n      const findIndex = carts.findIndex((value) => {\r\n        return value.id === data.id && value.size === data.size;\r\n      });\r\n      if (findIndex !== -1) {\r\n        let newArr = [...carts];\r\n        newArr[findIndex] = {\r\n          ...newArr[findIndex],\r\n          count: newArr[findIndex].count + 1,\r\n        };\r\n        const json = JSON.stringify(newArr);\r\n        localStorage.setItem(\"cart\", json);\r\n        return { carts: newArr };\r\n      }\r\n      const newData = { ...data, count: 1 };\r\n      const json = JSON.stringify([...carts, newData]);\r\n      localStorage.setItem(\"cart\", json);\r\n      return { carts: [...carts, newData] };\r\n    },\r\n    changeCount(state, { payload }) {\r\n      const { carts } = state;\r\n      const { count, data } = payload;\r\n      const findIndex = carts.findIndex((value) => {\r\n        return value.id === data.id && value.size === data.size;\r\n      });\r\n      let newArr;\r\n      if (count === 0) {\r\n        newArr = carts.filter(item => !(item.id === data.id && item.size === data.size))\r\n      } else {\r\n        newArr = [...carts];\r\n        newArr[findIndex] = {\r\n          ...newArr[findIndex],\r\n          count: count,\r\n        };\r\n      }\r\n      const json = JSON.stringify(newArr);\r\n      localStorage.setItem(\"cart\", json);\r\n      return { carts: newArr };\r\n    },\r\n    clear(state, { payload: data }) {\r\n      localStorage.setItem(\"cart\", []);\r\n      return { ...state, carts: null };\r\n    },\r\n  },\r\n};\r\n"],"sourceRoot":""}